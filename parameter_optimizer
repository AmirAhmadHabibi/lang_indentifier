import lang_modeler as q
import perplexer as p
import os
import pickle
import sys

def fileread(mt,size):
    print(" Please enter 1. ")
    model_list = []
    #creating a model for the training data and storing it.
    for filename in os.listdir(os.getcwd() + '/811_a1_train/'):
        with open( './811_a1_dev/' + filename, "r") as f:
            model = q.LangModeler(filename,f.read().replace('\n', ''), mt, size)
            model_list.append(model)
    with open(mt + size + '.pkl', 'wb') as f:
        pickle.dump(model_list, f)


    #Using the stored model to test the dev data
    for filename in os.listdir(os.getcwd()+'/811_a1_dev/'):
        with open( './811_a1_dev/' + filename, "r") as f:
            low_perplexer = sys.maxsize
            for model_obj in model_list:
                perplexer = p.pp(model_obj, f.read(), size)
                if perplexer < low_perplexer :
                    low_perplexer = perplexer
                    possible_filename = model_obj.name

method_list = ['unsmoothed', 'laplace','interpolation']
for i in range(1,6):
    for method in method_list:
        fileread(method , i)
